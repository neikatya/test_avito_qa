# TESTCASES: Ads Microservice API

**Base URL:** `https://qa-internship.avito.com`
**Data format:** JSON
**API versions:** v1, v2
**Важно:**

* `POST /api/1/item` возвращает JSON вида:

  ```json
  { "status": "Сохранили объявление - <id>" }
  ```

  где `<id>` — UUID объявления.
* `GET /api/1/item/{id}` возвращает **массив** с одним объектом объявления.
* `GET /api/1/statistic/{id}` и `GET /api/2/statistic/{id}` возвращают **массив** с одним объектом статистики.
* `DELETE /api/2/item/{id}` возвращает **200** и **пустое тело**.

---

## Общие проверки (для всех ручек)

* Корректный HTTP статус-код.
* При успехе: `Content-Type: application/json` (кроме `DELETE 200` с пустым телом).
* Структура ответа соответствует фактическому формату (см. выше).
* Для `400/404` — тело содержит JSON с информацией об ошибке (как в Postman-коллекции).

---

## 1) Создание объявления

### Endpoint

**POST `/api/1/item`**

### TC-1.1 Успешное создание объявления (валидные данные)

**Описание:** Создать объявление с валидными данными и получить `id` из `status`.
**Предусловие:** `sellerID` уникален (111111–999999).

**Request body:**

```json
{
  "sellerID": 111666,
  "name": "Test item",
  "price": 1000,
  "statistics": { "likes": 5, "viewCount": 1, "contacts": 35 }
}
```

**Ожидаемый результат:**

* Status code: **200**
* Response body:

  * содержит поле `status` (string)
  * строка начинается с `"Сохранили объявление - "`
  * из строки извлекается `<id>` (UUID) — **не пустой**

**Постусловие:** сохранить `item_id = <id>` для следующих тестов.

---

### TC-1.2 Создание объявления без обязательного поля `sellerID`

**Request:** тело без `sellerID`.

**Ожидаемый результат:**

* Status code: **400**
* Response body содержит описание ошибки (message / messages).

---

### TC-1.3 Невалидный тип `sellerID`

**Request:** `"sellerID": "111666"` (string вместо int)

**Ожидаемый результат:**

* Status code: **400**

---

### TC-1.4 Невалидный `price`

Варианты:

* `price = -1`
* `price = "1000"`

**Ожидаемый результат:**

* Status code: **400**

---

### TC-1.5 Невалидный `name`

Варианты:

* `name = ""`
* `name` очень длинное (например 300+ символов)

**Ожидаемый результат:**

* Status code: **400** (если есть валидация)
  или фиксация фактического поведения (если сервис принимает — это повод уточнять требования).

---

### TC-1.6 Невалидный блок `statistics`

Варианты:

* отсутствует `statistics`
* `statistics.likes = -1`
* `statistics.viewCount = "1"`

**Ожидаемый результат:**

* Status code: **400** (либо фиксация факта, если валидации нет)

---

## 2) Получение объявления по id

### Endpoint

**GET `/api/1/item/{id}`**

### TC-2.1 Получение существующего объявления по `item_id`

**Предусловие:** выполнен TC-1.1, есть `item_id`.

**Ожидаемый результат:**

* Status code: **200**
* Response body — **массив**
* В массиве **ровно 1 объект**
* Объект содержит поля:

  * `id` (string), `sellerId` (int), `name` (string), `price` (int), `statistics` (object), `createdAt` (string)
* `id == item_id`
* `sellerId == sellerID` из запроса создания (учесть нейминг: `sellerID` → `sellerId`)
* `name/price/statistics` совпадают с тем, что отправляли в POST

---

### TC-2.2 Получение по несуществующему id

**Request:** случайный UUID, который точно не создавали.

**Ожидаемый результат:**

* Status code: **404**

---

### TC-2.3 Получение по невалидному id

Варианты:

* пустой id `""`
* явно некорректная строка `abc`

**Ожидаемый результат:**

* Status code: **400** (либо фиксация факта, если сервис отдаёт 404)

---

## 3) Получение всех объявлений продавца

### Endpoint

**GET `/api/1/{sellerID}/item`**

### TC-3.1 Получить объявления продавца (sellerID с объявлениями)

**Предусловие:** создать минимум 2 объявления на одного `sellerID`.

**Ожидаемый результат:**

* Status code: **200**
* Response body — массив (>=2)
* У каждого объекта `sellerId == sellerID`
* В массиве присутствуют `item_id`, созданные на этом sellerID

---

### TC-3.2 Получение объявлений для sellerID без объявлений

**Request:** новый `sellerID` (уникальный), на который ничего не создавали.

**Ожидаемый результат:**

* Status code: **200**
* Response body — `[]` (пустой массив)

---

### TC-3.3 Невалидный sellerID в path

Варианты:

* `sellerID = "abc"`
* `sellerID` вне диапазона (если применимо)

**Ожидаемый результат:**

* Status code: **400** (или фиксация фактического поведения)

---

## 4) Получение статистики по объявлению

### Endpoints

**GET `/api/1/statistic/{id}`**
**GET `/api/2/statistic/{id}`**

### TC-4.1 Получение статистики по существующему объявлению (v1)

**Предусловие:** есть `item_id`.

**Ожидаемый результат:**

* Status code: **200**
* Response body — массив
* В массиве **ровно 1 объект**
* Объект содержит поля `likes`, `viewCount`, `contacts` (integer)
* Значения совпадают с тем, что задавали при создании (как на скриншоте)

---

### TC-4.2 Получение статистики по существующему объявлению (v2)

**Ожидаемый результат:**

* Status code: **200**
* Response body — массив, 1 объект
* Поля и значения совпадают с v1 для того же `item_id`

---

### TC-4.3 Статистика по несуществующему объявлению

**Ожидаемый результат:**

* Status code: **404**

---

### TC-4.4 Невалидный id в statistic

**Ожидаемый результат:**

* Status code: **400** (или фиксация фактического поведения)

---

## 5) Удаление объявления

### Endpoint

**DELETE `/api/2/item/{id}`**

### TC-5.1 Успешное удаление объявления

**Предусловие:** есть `item_id`.

**Ожидаемый результат:**

* Status code: **200**
* Response body пустой

---

### TC-5.2 Проверка после удаления (проверка консистентности)

**Предусловие:** выполнен TC-5.1.

**Ожидаемый результат:**

* GET `/api/1/item/{item_id}` → **404**
* GET `/api/1/statistic/{item_id}` → **404** (или фактическое поведение, если статистика хранится отдельно)
* GET `/api/2/statistic/{item_id}` → **404**
* GET `/api/1/{sellerID}/item` → в списке **нет** `item_id`

---

### TC-5.3 Удаление несуществующего объявления

**Ожидаемый результат:**

* Status code: **404**

---

### TC-5.4 Удаление с невалидным id

**Ожидаемый результат:**

* Status code: **400** (или фиксация фактического поведения)
